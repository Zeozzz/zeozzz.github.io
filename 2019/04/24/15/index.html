<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="澈崽子"><meta name="copyright" content="澈崽子"><meta name="generator" content="Hexo 5.0.0"><meta name="theme" content="hexo-theme-yun"><title>H3C 交换机配置命令详解 | 澈崽子 | 家有网工初长成</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="none" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.19/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_stqaphw3j4.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded", function() {
  renderMathInElement(document.body, {
    delimiters: [
      {left: "$$", right: "$$", display: true},
      {left: "$", right: "$", display: false},
      {left: "\\(", right: "\\)", display: false},
      {left: "\\[", right: "\\]", display: true}
    ]
  });
});</script><link class="aplayer-style-marker" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script class="aplayer-script-marker" src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" defer></script><script class="meting-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js" defer></script><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><link rel="alternate" href="/atom.xml" title="澈崽子 | 家有网工初长成" type="application/atom+xml"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"root":"/","title":"澈崽子的小窝","version":"0.9.5","anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><meta name="description" content="华为3COM交换机配置命令详解1、配置文件相关命令[Quidway]display current-configuration         ;显示当前生效的配置[Quidway]display saved-configuration           ；显示flash中配置文件，即下次上电启动时所用的配置文件reset saved-configuration           ；檫除旧的配">
<meta property="og:type" content="article">
<meta property="og:title" content="H3C 交换机配置命令详解">
<meta property="og:url" content="https://zeozzz.github.com/2019/04/24/15/index.html">
<meta property="og:site_name" content="澈崽子 | 家有网工初长成">
<meta property="og:description" content="华为3COM交换机配置命令详解1、配置文件相关命令[Quidway]display current-configuration         ;显示当前生效的配置[Quidway]display saved-configuration           ；显示flash中配置文件，即下次上电启动时所用的配置文件reset saved-configuration           ；檫除旧的配">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-04-24T07:37:25.000Z">
<meta property="article:modified_time" content="2019-04-24T07:39:16.964Z">
<meta property="article:author" content="澈崽子">
<meta property="article:tag" content="H3C">
<meta name="twitter:card" content="summary"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script defer src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button sidebar-nav-active" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel sidebar-panel-active" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="澈崽子"><img width="96" loading="lazy" src="/avatar.jfif" alt="澈崽子"></a><div class="site-author-name"><a href="/about/">澈崽子</a></div><a class="site-name" href="/about/site.html">澈崽子 | 家有网工初长成</a><sub class="site-subtitle"></sub><div class="site-desciption">念念不忘 必有回响</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">74</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">29</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">36</span></a></div><a class="site-state-item hty-icon-button" href="/links/" title="常用链接"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" title="QQ 群" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Zeozzz" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://weibo.com/linche521chn" title="微博" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.douban.com/people/zeozzz/" title="豆瓣" target="_blank" style="color:#007722"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-douban-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=46666755" title="网易云音乐" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/janz1995chn/activities" title="知乎" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/15054940" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/zeozzz" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://t.me/zeozzz" title="Telegram Channel" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:zhangzhe@live.in" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.now.sh/" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-send-plane-2-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" target="_blank" rel="noopener" href="https://ispip.clang.cn/" title="IP归属查询" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-information-line"></use></svg></a><a class="links-item hty-icon-button" target="_blank" rel="noopener" href="http://ping.pe" title="ping工具" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-questionnaire-line"></use></svg></a><a class="links-item hty-icon-button" target="_blank" rel="noopener" href="https://photos.oneplus.com/cn" title="每日一图" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-gallery-line"></use></svg></a><a class="links-item hty-icon-button" target="_blank" rel="noopener" href="https://smallpdf.com/cn" title="PDF工具" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></a><a class="links-item hty-icon-button" target="_blank" rel="noopener" href="https://www.runoob.com/" title="菜鸟教程" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-pushpin-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content">此文章未包含目录</div></div></div><div class="tag-cloud"><div class="tag-cloud-tags"><a href="/tags/802-1x/" style="font-size: 12px; color: #999">802.1x</a> <a href="/tags/ARP/" style="font-size: 12px; color: #999">ARP</a> <a href="/tags/CASE/" style="font-size: 12px; color: #999">CASE</a> <a href="/tags/Cisco/" style="font-size: 12px; color: #999">Cisco</a> <a href="/tags/H3C/" style="font-size: 30px; color: #0078e7">H3C</a> <a href="/tags/IDC/" style="font-size: 12px; color: #999">IDC</a> <a href="/tags/IPv6/" style="font-size: 24px; color: #3383cd">IPv6</a> <a href="/tags/LINUX/" style="font-size: 18px; color: #668eb3">LINUX</a> <a href="/tags/Linux/" style="font-size: 12px; color: #999">Linux</a> <a href="/tags/NAT/" style="font-size: 24px; color: #3383cd">NAT</a> <a href="/tags/OSPF/" style="font-size: 12px; color: #999">OSPF</a> <a href="/tags/RAID/" style="font-size: 12px; color: #999">RAID</a> <a href="/tags/SDN/" style="font-size: 24px; color: #3383cd">SDN</a> <a href="/tags/SSL/" style="font-size: 12px; color: #999">SSL</a> <a href="/tags/TCP/" style="font-size: 18px; color: #668eb3">TCP</a> <a href="/tags/TCP-IP/" style="font-size: 12px; color: #999">TCP/IP</a> <a href="/tags/VLAN/" style="font-size: 18px; color: #668eb3">VLAN</a> <a href="/tags/VPN/" style="font-size: 12px; color: #999">VPN</a> <a href="/tags/VXLAN/" style="font-size: 12px; color: #999">VXLAN</a> <a href="/tags/git/" style="font-size: 12px; color: #999">git</a></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://zeozzz.github.com/2019/04/24/15/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="澈崽子"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="澈崽子 | 家有网工初长成"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">H3C 交换机配置命令详解</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2019-04-24 15:37:25" itemprop="dateCreated datePublished" datetime="2019-04-24T15:37:25+08:00">2019-04-24</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="本文字数">3.6k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="阅读时长">15m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><span class="leancloud_visitors" id="/2019/04/24/15/" data-flag-title="H3C 交换机配置命令详解"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-tag"><a class="tag" href="/tags/H3C/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">H3C</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><p>华为3COM交换机配置命令详解<br>1、配置文件相关命令<br>[Quidway]display current-configuration         ;显示当前生效的配置<br>[Quidway]display saved-configuration           ；显示flash中配置文件，即下次上电启动时所用的配置文件<br><Quidway>reset saved-configuration           ；檫除旧的配置文件<br><Quidway>reboot                                    ；交换机重启<br><Quidway>display version                          ；显示系统版本信息<br>2、基本配置<br>[Quidway]super password                                     ；修改特权用户密码<br>[Quidway]sysname                                     ；交换机命名<br>[Quidway]interface ethernet 0/1                            ；进入接口视图<br>[Quidway]interface vlan x                            ；进入接口视图<br>[Quidway-Vlan-interfacex]ip address 10.65.1.1 255.255.0.0    ；配置VLAN的IP地址<br>[Quidway]ip route-static 0.0.0.0 0.0.0.0 10.65.1.2          ；静态路由＝网关<br>3、telnet配置<br>[Quidway]user-interface vty 0 4                            ；进入虚拟终端<br>[S3026-ui-vty0-4]authentication-mode password                ；设置口令模式<br>[S3026-ui-vty0-4]set authentication-mode password simple 222  ；设置口令<br>[S3026-ui-vty0-4]user privilege level 3                      ；用户级别<br>4、端口配置<br>[Quidway-Ethernet0/1]duplex {half|full|auto}                ；配置端口工作状态<br>[Quidway-Ethernet0/1]speed {10|100|auto}                ；配置端口工作速率<br>[Quidway-Ethernet0/1]flow-control                      ；配置端口流控<br>[Quidway-Ethernet0/1]mdi {across|auto|normal}                ；配置端口平接扭接<br>[Quidway-Ethernet0/1]port link-type {trunk|access|hybrid}    ；设置端口工作模式<br>[Quidway-Ethernet0/1]undo shutdown                      ；激活端口<br>[Quidway-Ethernet0/2]quit                            ；退出系统视图<br>5、链路聚合配置<br>[DeviceA] link-aggregation group 1 mode manual     ；创建手工聚合组1<br>[DeviceA] interface ethernet 1/0/1                             ；将以太网端口Ethernet1/0/1加入聚合组1<br>[DeviceA-Ethernet1/0/1] port link-aggregation group 1<br>[DeviceA-Ethernet1/0/1] interface ethernet 1/0/2              ；将以太网端口Ethernet1/0/1加入聚合组1<br>[DeviceA-Ethernet1/0/2] port link-aggregation group 1<br>[DeviceA] link-aggregation group 1 service-type tunnel        # 在手工聚合组的基础上创建Tunnel业务环回组。<br>[DeviceA] interface ethernet 1/0/1                                    # 将以太网端口Ethernet1/0/1加入业务环回组。<br>[DeviceA-Ethernet1/0/1] undo stp<br>[DeviceA-Ethernet1/0/1] port link-aggregation group 1<br>6、端口镜像<br>[Quidway]monitor-port <interface_type interface_num>       　；指定镜像端口<br>[Quidway]port mirror <interface_type interface_num>    　　；指定被镜像端口<br>[Quidway]port mirror int_list observing-port int_type int_num ；指定镜像和被镜像<br>7、VLAN配置<br>[Quidway]vlan 3                                  　　　　　　；创建VLAN<br>[Quidway-vlan3]port ethernet 0/1 to ethernet 0/4 　　　　　；在VLAN中增加端口<br>配置基于access的VLAN<br>[Quidway-Ethernet0/2]port access vlan 3          　　　　　；当前端口加入到VLAN<br>注意：缺省情况下，端口的链路类型为Access类型，所有Access端口均属于且只属于VLAN1<br>配置基于trunk的VLAN<br>[Quidway-Ethernet0/2]port link-type trunk                          ；设置当前端口为trunk<br>[Quidway-Ethernet0/2]port trunk permit vlan {ID|All}    　　；设trunk允许的VLAN<br>注意：所有端口缺省情况下都是允许VLAN1的报文通过的<br>[Quidway-Ethernet0/2]port trunk pvid vlan 3    　　　　　；设置trunk端口的PVID<br>配置基于Hybrid端口的VLAN<br>[Quidway-Ethernet0/2]port link-type hybrid                  ;配置端口的链路类型为Hybrid类型<br>[Quidway-Ethernet0/2]port hybrid vlan vlan-id-list { tagged | untagged }     ;允许指定的VLAN通过当前Hybrid端口<br>注意：缺省情况下，所有Hybrid端口只允许VLAN1通过<br>[Quidway-Ethernet0/2]port hybrid pvid vlan vlan-id              ;设置Hybrid端口的缺省VLAN<br>注意：缺省情况下，Hybrid端口的缺省VLAN为VLAN1<br>VLAN描述<br>[Quidway]description string                      　　　　　；指定VLAN描述字符<br>[Quidway]description                         　　　　　　；删除VLAN描述字符<br>[Quidway]display vlan [vlan_id]                            ；查看VLAN设置<br>私有VLAN配置<br>[SwitchA-vlanx]isolate-user-vlan enable          　　　　　；设置主vlan<br>[SwitchA]Isolate-user-vlan <x> secondary <list>    　　　　　；设置主vlan包括的子vlan<br>[Quidway-Ethernet0/2]port hybrid pvid vlan <id>    　　　　　；设置vlan的pvid<br>[Quidway-Ethernet0/2]port hybrid pvid             　　　　　；删除vlan的pvid<br>[Quidway-Ethernet0/2]port hybrid vlan vlan_id_list untagged 　；设置无标识的vlan<br>如果包的vlan id与PVId一致，则去掉vlan信息. 默认PVID=1。<br>所以设置PVID为所属vlan id, 设置可以互通的vlan为untagged.<br>8、STP配置<br>[Quidway]stp {enable|disable}                               ；设置生成树,默认关闭<br>[Quidway]stp mode rstp                                         ；设置生成树模式为rstp<br>[Quidway]stp priority 4096                         　　　　　；设置交换机的优先级<br>[Quidway]stp root {primary|secondary}             　　　　　；设置为根或根的备份<br>[Quidway-Ethernet0/1]stp cost 200                　　　　　；设置交换机端口的花费<br>MSTP配置：<br>配置MST域名为info，MSTP修订级别为1，VLAN映射关系为VLAN2～VLAN10映射到生成树实例1上，VLAN20～VLAN30映射生成树实例2上。<br><Sysname> system-view<br>[Sysname] stp region-configuration<br>[Sysname-mst-region] region-name info<br>[Sysname-mst-region] instance 1 vlan 2 to 10<br>[Sysname-mst-region] instance 2 vlan 20 to 30<br>[Sysname-mst-region] revision-level 1<br>[Sysname-mst-region] active region-configuration<br>9、MAC地址表的操作<br>在系统视图下添加MAC地址表项<br>[Quidway]mac-address { static | dynamic | blackhole } mac-address interface interface-type interface-number vlan vlan-id  ；添加MAC地址表项<br>在添加MAC地址表项时，命令中interface参数指定的端口必须属于vlan参数指定的VLAN，否则将添加失败。<br>如果vlan参数指定的VLAN是动态VLAN，在添加静态MAC地址之后，会自动变为静态VLAN。<br>在以太网端口视图下添加MAC地址表项<br>[Quidway-Ethernet0/2]mac-address { static | dynamic | blackhole } mac-address vlan vlan-id<br>在添加MAC地址表项时，当前的端口必须属于命令中vlan参数指定的VLAN，否则将添加失败；<br>如果vlan参数指定的VLAN是动态VLAN，在添加静态MAC地址之后，会自动变为静态VLAN。<br>[Quidway]mac-address timer { aging age | no-aging }   ；设置MAC地址表项的老化时间<br>注意：缺省情况下，MAC地址表项的老化时间为300秒，使用参数no-aging时表示不对MAC地址表项进行老化。<br>MAC地址老化时间的配置对所有端口都生效，但地址老化功能只对动态的（学习到的或者用户配置可老化的）MAC地址表项起作用。<br>[Quidway-Ethernet0/2]mac-address max-mac-count count   ；设置端口最多可以学习到的MAC地址数量<br>注意：缺省情况下，没有配置对端口学习MAC地址数量的限制。反之，如果端口启动了MAC地址认证和端口安全功能，则不能配置该端口的最大MAC地址学习个数。<br>[Quidway-Ethernet0/2]port-mac start-mac-address    ；配置以太网端口MAC地址的起始值<br>在缺省情况下，E126/E126A交换机的以太网端口是没有配置MAC地址的，因此当交换机在发送二层协议报文（例如STP）时，由于无法取用发送端口的MAC地址，<br>将使用该协议预置的MAC地址作为源地址填充到报文中进行发送。在实际组网中，由于多台设备都使用相同的源MAC地址发送二层协议报文，会造成在某台设备的不<br>同端口学习到相同MAC地址的情况，可能会对MAC地址表的维护产生影响。<br>[Quidway]display mac-address       ；显示地址表信息<br>[Quidway]display mac-address aging-time         ；显示地址表动态表项的老化时间<br>[Quidway]display port-mac            ；显示用户配置的以太网端口MAC地址的起始值<br>10、GVRP配置<br>[SwitchA] gvrp      # 开启全局GVRP<br>[SwitchA-Ethernet1/0/1] gvrp     # 在以太网端口Ethernet1/0/1上开启GVRP<br>[SwitchE-Ethernet1/0/1] gvrp registration { fixed | forbidden | normal }   #  配置GVRP端口注册模式    缺省为normal<br>[SwitchA] display garp statistics [ interface interface-list ]    ；显示GARP统计信息<br>[SwitchA] display garp timer [ interface interface-list ]       ；显示GARP定时器的值<br>[SwitchA] display gvrp statistics [ interface interface-list ]    ；显示GVRP统计信息<br>[SwitchA] display gvrp status                                             ；显示GVRP的全局状态信息<br>[SwitchA] display gvrp statusreset garp statistics [ interface interface-list ]    ；清除GARP统计信息<br>11、DLDP配置<br>[SwitchA] interface gigabitethernet 1/1/1        # 配置端口工作在强制全双工模式，速率为1000Mbits/s。<br>[SwitchA-GigabitEthernet1/1/1] duplex full<br>[SwitchA-GigabitEthernet1/1/1] speed 1000<br>[SwitchA] dldp enable       # 全局开启DLDP。<br>[SwitchA] dldp interval 15    # 设置发送DLDP报文的时间间隔为15秒。<br>[SwitchA]  dldp work-mode { enhance | normal }   # 配置DLDP协议的工作模式为加强模式。     缺省为normal<br>[SwitchA] dldp unidirectional-shutdown  { auto | manual }    # 配置DLDP单向链路操作模式为自动模式。  缺省为auto<br>[SwitchA] display dldp 1     # 查看DLDP状态。<br>当光纤交叉连接时，可能有两个或三个端口处于Disable状态，剩余端口处于Inactive状态。<br>当光纤一端连接正确，一端未连接时：<br>如果DLDP的工作模式为normal，则有收光的一端处于Advertisement状态，没有收光的一端处于Inactive状态。<br>如果DLDP的工作模式为enhance，则有收光的一端处于Disable状态，没有收光的一端处于Inactive状态。<br>dldp reset命令在全局下可以重置所有端口的DLDP状态，在接口下可以充值该端口的DLDP状态<br>12、端口隔离配置<br>通过端口隔离特性，用户可以将需要进行控制的端口加入到一个隔离组中，实现隔离组中的端口之间二层、三层数据的隔离，既增强了网络的安全性，也为用户<br>提供了灵活的组网方案。<br>[Sysname] interface ethernet1/0/2   # 将以太网端口Ethernet1/0/2加入隔离组。<br>[Sysname-Ethernet1/0/2] port isolate<br>[Sysname]display isolate port   # 显示隔离组中的端口信息<br>配置隔离组后，只有隔离组内各个端口之间的报文不能互通，隔离组内端口与隔离组外端口以及隔离组外端口之间的通信不会受到影响。<br>端口隔离特性与以太网端口所属的VLAN无关。<br>当汇聚组中的某个端口加入或离开隔离组后，本设备中同一汇聚组内的其它端口，均会自动加入或离开该隔离组。<br>对于既处于某个聚合组又处于某个隔离组的一组端口，其中的一个端口离开聚合组时不会影响其他端口，即其他端口仍将处于原聚合组和原隔离组中。<br>如果某个聚合组中的端口同时属于某个隔离组，当在系统视图下直接删除该聚合组后，该聚合组中的端口仍将处于该隔离组中。<br>当隔离组中的某个端口加入聚合组时，该聚合组中的所有端口，将会自动加入隔离组中。<br>13、端口安全配置<br>[Switch] port-security enable   # 启动端口安全功能<br>[Switch] interface Ethernet 1/0/1  # 进入以太网Ethernet1/0/1端口视图<br>[Switch-Ethernet1/0/1] port-security max-mac-count 80  # 设置端口允许接入的最大MAC地址数为80<br>[Switch-Ethernet1/0/1] port-security port-mode autolearn  # 配置端口的安全模式为autolearn<br>[Switch-Ethernet1/0/1] mac-address security 0001-0002-0003 vlan 1   # 将Host 的MAC地址0001-0002-0003作为Security MAC添加到VLAN 1中<br>[Switch-Ethernet1/0/1] port-security intrusion-mode disableport-temporarily   # 设置Intrusion Protection特性被触发后，暂时关闭该端口<br>[Switch]port-security timer disableport 30       # 关闭时间为30秒。<br>14、端口绑定配置<br>通过端口绑定特性，网络管理员可以将用户的MAC地址和IP地址绑定到指定的端口上。进行绑定操作后，交换机只对从该端口收到的指定MAC地址和IP地<br>址的用户发出的报文进行转发，提高了系统的安全性，增强了对网络安全的监控。<br>[SwitchA-Ethernet1/0/1] am user-bind mac-addr 0001-0002-0003 ip-addr 10.12.1.1   # 将Host 1的MAC地址和IP地址绑定到Ethernet1/0/1端口。<br>有的交换机上绑定的配置不一样<br>[SwitchA] interface ethernet 1/0/2<br>[SwitchA-Ethernet1/0/2] user-bind ip-address 192.168.0.3 mac-address 0001-0203-0405<br>端口过滤配置<br>[SwitchA] interface ethernet1/0/1      # 配置端口Ethernet1/0/1的端口过滤功能。<br>[SwitchA-Ethernet1/0/1] ip check source ip-address mac-address<br>[SwitchA] dhcp-snooping        # 开启DHCP Snooping功能。<br>[SwitchA] interface ethernet1/0/2       # 设置与DHCP服务器相连的端口Ethernet1/0/2为信任端口。<br>[SwitchA-Ethernet1/0/2] dhcp-snooping trust<br>在端口Ethernet1/0/1上启用IP过滤功能，防止客户端使用伪造的不同源IP地址对服务器进行攻击<br>15、BFD配置<br>Switch A、Switch B、Switch C相互可达，在Switch A上配置静态路由可以到达Switch C，并使能BFD检测功能。<br> 在Switch A上配置静态路由，并使能BFD检测功能，通过BFD echo报文方式实现BFD功能。<br><SwitchA> system-view<br>[SwitchA] bfd echo-source-ip 123.1.1.1<br>[SwitchA] interface vlan-interface 10<br>[SwitchA-vlan-interface10] bfd min-echo-receive-interval 300<br>[SwitchA-vlan-interface10] bfd detect-multiplier 7<br>[SwitchA-vlan-interface10] quit<br>[SwitchA] ip route-static 120.1.1.1 24 10.1.1.100 bfd echo-packet<br> 在Switch A上打开BFD功能调试信息开关。<br><SwitchA> debugging bfd event<br><SwitchA> debugging bfd scm<br><SwitchA> terminal debugging<br>在Switch A上可以打开BFD功能调试信息开关，断开Hub和Switch B之间的链路，验证配置结果。验证结果显示，<br>Switch A能够快速感知Switch A与Switch B之间链路的变化。<br>16、QinQ配置<br>Provider A、Provider B之间通过Trunk端口连接，Provider A属于运营商网络的VLAN1000，Provider B属于运营商网络的VLAN2000。<br>Provider A和Provider B之间，运营商采用其他厂商的设备，TPID值为0x8200。<br>希望配置完成后达到下列要求：<br>Customer A的VLAN10的报文可以和Customer B的VLAN10的报文经过运营商网络的VLAN1000转发后互通；Customer A的VLAN20的报文可以<br>和Customer C的VLAN20的报文经过运营商网络的VLAN2000转发后互通。<br>[ProviderA] interface ethernet 1/0/1   # 配置端口为Hybrid端口，且允许VLAN10，VLAN20，VLAN1000和VLAN2000的报文通过，并且在发送时去掉外层Tag。<br>[ProviderA-Ethernet1/0/1] port link-type hybrid<br>[ProviderA-Ethernet1/0/1] port hybrid vlan 10 20 1000 2000 untagged<br>[ProviderA-Ethernet1/0/1] qinq vid 1000     # 将来自VLAN10的报文封装VLAN ID为1000的外层Tag。<br>[ProviderA-Ethernet1/0/1-vid-1000] raw-vlan-id inbound 10<br>[ProviderA-Ethernet1/0/1-vid-1000] quit<br>[ProviderA-Ethernet1/0/1] qinq vid 2000    # 将来自VLAN20的报文封装VLAN ID为2000的外层Tag。<br>[ProviderA-Ethernet1/0/1-vid-2000] raw-vlan-id inbound 20<br>[ProviderA] interface ethernet 1/0/2    # 配置端口的缺省VLAN为VLAN1000。<br>[ProviderA-Ethernet1/0/2] port access vlan 1000<br>[ProviderA-Ethernet1/0/2] qinq enable   # 配置端口的基本QinQ功能，将来自VLAN10的报文封装VLAN ID为1000的外层Tag。<br>[ProviderA] interface ethernet 1/0/3   # 配置端口为Trunk端口，且允许VLAN1000和VLAN2000的报文通过。<br>[ProviderA-Ethernet1/0/3] port link-type trunk<br>[ProviderA-Ethernet1/0/3] port trunk permit vlan 1000 2000<br>[ProviderA-Ethernet1/0/3] qinq ethernet-type 8200   # 为与公共网络中的设备进行互通，配置端口添加外层Tag时采用的TPID值为0x8200。<br>[ProviderB] interface ethernet 1/0/1   # 配置端口为Trunk端口，且允许VLAN1000和VLAN2000的报文通过。<br>[ProviderB-Ethernet1/0/1] port link-type trunk<br>[ProviderB-Ethernet1/0/1] port trunk permit vlan 1000 2000<br>[ProviderB-Ethernet1/0/1] qinq ethernet-type 8200   # 为与公共网络中的设备进行互通，配置端口添加外层Tag时采用的TPID值为0x8200。<br>[ProviderB-Ethernet1/0/1] quit<br>[ProviderB] interface ethernet 1/0/2   # 配置端口的缺省VLAN为VLAN2000。<br>[ProviderB-Ethernet1/0/2] port access vlan 2000<br>[ProviderB-Ethernet1/0/2] qinq enable   # 配置端口的基本QinQ功能，将来自VLAN20的报文封装VLAN ID为2000的外层Tag。</p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"></div><div style="display:inline-block"></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>澈崽子</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://zeozzz.github.com/2019/04/24/15/" title="H3C 交换机配置命令详解">https://zeozzz.github.com/2019/04/24/15/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2019/04/24/16/" rel="prev" title="子网掩码、反掩码以及ospf network命令误区"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">子网掩码、反掩码以及ospf network命令误区</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2019/04/24/14/" rel="next" title="100.64.0.1运营商级(Carrier-grade)NAT保留IP地址"><span class="post-nav-text">100.64.0.1运营商级(Carrier-grade)NAT保留IP地址</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="http://www.beian.miit.gov.cn" target="_blank">冀ICP备15029595号-1</a></div><div class="copyright"><span>&copy; 2015 – 2020 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> 澈崽子</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.0.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v0.9.5</span></div><div class="live_time"><span>本博客已萌萌哒地运行</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2015-09-01T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div><div id="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv" title="总访客量"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="总访问量"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div id="local-search-result"></div></div><script>let date = new Date();
let today = (date.getMonth() + 1) + "-" + date.getDate()
if ("4-4,9-18".indexOf(today) !== -1) {
  document.documentElement.style.filter = "grayscale(1)";
}</script></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"live2d-widget-model-hijiki"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"tagMode":false});</script></body></html>